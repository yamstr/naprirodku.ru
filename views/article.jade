extends ./layout.jade

block title
    title #{article.place.name}: #{article.title}

block description
    meta(name='description', content=article.lead)

block og
    meta(property='og:type', content='article')
    meta(property='og:url', content='http://naprirodku.ru/articles/#{article.id}/')
    meta(property='og:image', content='http://naprirodku.ru/articles/#{article.id}/photos/cover.jpg')
    meta(property='og:title', content='#{article.place.name}: #{article.title}')
    meta(property='og:description', content=article.lead)

block content
    .container
        .row
            .col-md-7.place
                | !{article.body}
                #hypercomments_widget
                script(type='text/javascript').
                    _hcwp = window._hcwp || [];
                    _hcwp.push({widget:"Stream", widget_id: 73569});
                    (function() {
                        if("HC_LOAD_INIT" in window)return;
                        HC_LOAD_INIT = true;
                        var lang = (navigator.language || navigator.systemLanguage || navigator.userLanguage || "en").substr(0, 2).toLowerCase();
                        var hcc = document.createElement("script"); hcc.type = "text/javascript"; hcc.async = true;
                        hcc.src = ("https:" == document.location.protocol ? "https" : "http")+"://w.hypercomments.com/widget/hc/73569/"+lang+"/widget.js";
                        var s = document.getElementsByTagName("script")[0];
                        s.parentNode.insertBefore(hcc, s.nextSibling);
                    })();
            .col-md-4.col-md-offset-1
                .header
                    h2(style='color: #999') Расположение
                #map(style='height: 250px')
                script(type='text/javascript').
                    function initMap() {
                        var map = new google.maps.Map(document.getElementById('map'), {
                            center: {
                                lat: #{article.place.position.lat},
                                lng: #{article.place.position.lng}
                            },
                            scrollwheel: false,
                            disableDefaultUI: true,
                            zoomControl: true,
                            zoom: 10
                        });

                        var marker = new google.maps.Marker({
                            map: map,
                            position: {
                                lat: #{article.place.position.lat},
                                lng: #{article.place.position.lng}
                            }
                        });
                    }
                script(src='//maps.googleapis.com/maps/api/js?key=AIzaSyBS1iXc1LK53yU-_bkbBuFi3rDatIoqBa8&callback=initMap')
                table.table
                    tr
                        td Адрес
                        td #{article.place.address}
                    tr
                        td Координаты
                        td [#{article.place.position.lat},#{article.place.position.lng}]
                .header
                    h2(style='color: #999') Поделиться
                script(type='text/javascript', src='//yastatic.net/es5-shims/0.0.2/es5-shims.min.js', charset='utf-8')
                script(type='text/javascript', src='//yastatic.net/share2/share.js', charset='utf-8')
                .ya-share2(data-services='vkontakte,facebook,gplus,twitter', data-counter='')
                .header
                    h2(style='color: #999') Новые места
                each article in articles
                    include lead
    script(type='text/javascript').
        $(document).ready(function() {
            $('.place img').parent('a').addClass('fancybox').attr('rel', 'gallery');
            $('.fancybox').fancybox();
        });